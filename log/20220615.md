### rCore 实验第八章

###### semaphore 系统调用

> 同 mutex 系统调用类似，也是在进程的资源中增加一个 semaphore_list 向量，只不过 semaphore 内部不再是 locked 标志，而是一个 count 计数，通过 up 和 down 来进行 P、V 操作

###### 条件变量机制

> 管程的入口和出口由编译器保证了实现互斥，线程在调用管程时，若发现了某个变量不满足，则进入睡眠，但是会先释放掉管程入口的锁，当另一个线程释放条件变量，此时可以唤醒阻塞在这个条件变量上的某个线程
>
> 唤醒线程后，需要避免两个线程同时在管程中运行
>
> 1. Hoare：唤醒线程后，马上阻塞自己
> 2. Hansen：执行唤醒操作的线程立刻退出管程
> 3. Mesa：执行唤醒操作的线程继续执行，等它退出时，被唤醒的线程才能开始运行
>
> 具体实现：condvar 系统调用
>
> 进程中 PCB 中设置了一个 condvar_list 条件变量向量，每个 Condvar 中设置了一个等待队列 wait_queue

### 开始整理 rCore 的实验报告